version: 2

jobs:
  build:
    docker:
      - image: cimg/php:8.1

    steps:
      - checkout
      - run: sudo apt-get update -qq && sudo apt-get install --no-install-recommends --no-install-suggests -qq redis
      - run: yes '' | sudo pecl install -f redis
      - run: sudo docker-php-ext-enable redis.so
      - run: composer update
      - run: composer analyse
      - run: composer lint
      - run: composer test
